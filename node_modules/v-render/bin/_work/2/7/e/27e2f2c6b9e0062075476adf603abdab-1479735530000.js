!function(){var e=VRender.Utils,t=VRender.plugins.singlepage=function(e){},r=$("body"),n=null,i=null,a={},o=["animate_default"],u="animate_default";t.init=function(t){e.isNotBlank(t&&t.target)&&(r=$(t.target))},t.setViewHandler=function(e){n=e},VRender.navigate=function(t,n){if(!e.isBlank(t)){var o="string"==typeof t?{router:t}:t;if(o=$.extend({},o,{replace:!1,trigger:!0,animate:!1,retain:!1},n),o.trigger=e.isTrue(o.trigger),o.replace=e.isTrue(o.replace),o.retain=e.isTrue(o.retain),VRender.trigger(VRender.event_routerbefore,o),e.isNotBlank(o.router)&&o.isDefaultPrevented!==!0){if(o.retain){var u=i?i.router:"__root_router";a[u]=r.children()}if(o.replace){if(!e.isFunction(history.replaceState))return window.location.replace(o.router);history.replaceState(o,o.title,o.router),o.trigger&&VRender.trigger(VRender.event_routerchange,o)}else{if(!e.isFunction(history.pushState))return window.location=o.router;history.pushState(o,o.title,o.router),o.trigger&&VRender.trigger(VRender.event_routerchange,o)}i=o}}},window.addEventListener("popstate",function(){var e=history.state||{};e.isPopstate=!0,VRender.trigger(VRender.event_statepop,e),VRender.trigger(VRender.event_routerchange,e)}),VRender.on(VRender.event_routerchange,function(t,n){var i=s(n);d(n,function(t,a){var o=!!n.isPopstate;e.isFunction(i)?i(n,r,a,o):"animate_default"===i?c(n,r,a,o):n.retain&&!o?(r.children().detach(),r.append(a)):r.empty().append(a)})});var s=function(t){var r=t.isPopstate?i.animate:t.animate;return r===!0?u:e.isFunction(r)?r:!("string"!=typeof r||!o.indexOf(r))&&r},d=function(t,r){if(t&&t.isPopstate){var i=t.router||"__root_router",o=a[i];if(o)return delete a[i],r(!1,o)}e.isFunction(n)?n(t,function(e,t){r(!1,e?"":t)}):VRender.require(t.router,function(e,t){r(!1,e?"":t)})},c=function(e,t,r,n){var i=300;t.addClass("singlepage-animate-default do"),setTimeout(function(){e.retain&&!n?t.children().detach():t.children().remove(),t.append(r),t.removeClass("do"),setTimeout(function(){t.removeClass("singlepage-animate-default")},i)},i)}}();